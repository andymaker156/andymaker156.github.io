!function t(e,o,i){function n(s,a){if(!o[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=o[s]={exports:{}};e[s][0].call(c.exports,function(t){var o=e[s][1][t];return n(o?o:t)},c,c.exports,t,e,o,i)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(t,e){"use strict";function o(t,e){var o=document.querySelector(t);if(!(o instanceof HTMLElement))throw new Error(t+" must be an HTMLElement");o.innerHTML="",this._container=document.createElement("div"),o.appendChild(this._container),this._sudoku=e,this._built=!1,this._addEventListeners(),this.build()}var i=t("./constants");o.prototype.build=function(){if(!this._built){for(var t,e=new Array(i.BOARD_SIZE),o=new Array(i.BOARD_SIZE),n=0;n<i.BOARD_SIZE;n++)e[n]=document.createElement("div"),e[n].className="box",o[n]=new Array(i.BOARD_SIZE);for(var r=0;r<i.BOARD_SIZE;r++){for(var s=3*parseInt(r/3),a=r%3*3,u=s;s+3>u;u++)for(var c=a;a+3>c;c++){var l=document.createElement("div");l.className="cell";var d=document.createElement("input");d.setAttribute("type","number"),d.dataset.row=u,d.dataset.column=c,l.appendChild(d),this._sudoku.isPredefined(u,c)?(d.value=this._sudoku.getCellAt(u,c),d.disabled=!0,l.classList.add("cell-is-predefined")):t||(t=d),o[u][c]=l,e[r].appendChild(l)}this._container.appendChild(e[r])}this._built=!0,this._boxes=e,this._cells=o,t.focus()}},o.prototype.update=function(){var t=this._sudoku.isSolved();this.build(),this._checkSolution(),this._presentConflicts(),this._sudoku.forEachCell(function(e,o,n){var r=this._cells[o][n],s=r.querySelector("input");e==i.EMPTY_CELL?(r.classList.remove("cell-fade-in"),s.value=""):(t&&s.value!=e?r.classList.add("cell-fade-in"):r.classList.remove("cell-fade-in"),s.value=e),r.classList.remove("cell-hint")},this)},o.prototype.getField=function(t,e){var o=this._cells[t][e],i=o.querySelector("input");return i},o.prototype.focusField=function(t,e){var o=this.getField(t,e);return o.focus(),o},o.prototype.nextHint=function(){var t=this._sudoku.getNextAnswer();if(t){var e=this._cells[t.row][t.column],o=this.getField(t.row,t.column);o.blur(),o.value=t.answer,this._sudoku.setCellAt(t.answer,t.row,t.column),this._presentConflicts(),this._checkSolution(),e.classList.add("cell-hint"),this._focusNextTextField(t.row,t.column),setTimeout(function(){e.classList.remove("cell-hint")},500)}},o.prototype._focusNextTextField=function(t,e){t=parseInt(t),e=parseInt(e)+1;for(var o=!1,n=t;n<i.BOARD_SIZE&&!o;n++){for(var r=e;r<i.BOARD_SIZE&&!o;r++)this._sudoku.isPredefined(n,r)||(setTimeout(this.focusField.bind(this,n,r),200),o=!0);e=0}},o.prototype._addEventListeners=function(){this._container.addEventListener("keydown",this._keydownHandler.bind(this),!1)},o.prototype._keydownHandler=function(t){var e,o,n,r,s=t.target,a=9,u=48;if(t.keyCode!==a&&(s||"INPUT"===s.tagName)){if(this._container.classList.contains("sudoku-solved"))return t.preventDefault(),!1;e=t.keyCode-u,o=s.dataset.row,n=s.dataset.column,1>e||e>9?(s.value="",this._sudoku.setCellAt(i.EMPTY_CELL,o,n)):(s.value=e,this._sudoku.setCellAt(e,o,n)),s.classList.remove("cell-hint"),r=this._presentConflicts(),0===r&&e>=1&&9>=e&&this._focusNextTextField(o,n),this._checkSolution(),t.preventDefault()}},o.prototype._presentConflicts=function(){var t=this._sudoku.getAllConflicts(),e={};return t.cells.forEach(function(t){e[t[0]+","+t[1]]=!0}),this._sudoku.forEachCell(function(o,i,n){var r=this._sudoku.getBoxIndexFor(i,n),s=this._cells[i][n];e[i+","+n]?s.classList.add("cell-has-conflict"):s.classList.remove("cell-has-conflict"),-1!==t.rows.indexOf(i)?s.classList.add("row-has-conflict"):s.classList.remove("row-has-conflict"),-1!==t.columns.indexOf(n)?s.classList.add("column-has-conflict"):s.classList.remove("column-has-conflict"),-1!==t.boxes.indexOf(r)?this._boxes[r].classList.add("box-has-conflict"):this._boxes[r].classList.remove("box-has-conflict")},this),t.cells.length},o.prototype._checkSolution=function(){this._sudoku.isSolved()?this._container.classList.add("sudoku-solved"):this._container.classList.remove("sudoku-solved")},e.exports=o},{"./constants":5}],2:[function(t,e){"use strict";function o(t){this.setDifficulty(t),this._hasSolution=!1,this._board=new Array(n.BOARD_SIZE),this._solution=new Array(n.BOARD_SIZE);for(var e=0;e<n.BOARD_SIZE;e++)this._board[e]=new Array(n.BOARD_SIZE),this._solution[e]=new Array(n.BOARD_SIZE);this.resetGame()}var i=t("./assert"),n=t("./constants");o.prototype.clearBoard=function(t){var e,o;if(t)for(e=0;e<n.BOARD_SIZE;e++)for(o=0;o<n.BOARD_SIZE;o++)this.isPredefined(e,o)||(this._board[e][o]=n.EMPTY_CELL);else for(this._predefined={},this._hasSolution=!1,e=0;e<n.BOARD_SIZE;e++)for(o=0;o<n.BOARD_SIZE;o++)this._board[e][o]=n.EMPTY_CELL},o.prototype.setDifficulty=function(t){i(t>=n.DIFFICULTY_BEGINNER&&t<=n.DIFFICULTY_EMPTY,t+" is not a valid difficulty"),this._difficulty=t},o.prototype.getDifficulty=function(){return this._difficulty},o.prototype.resetGame=function(){var t,e,o=[40,30,25,20,15,0],i=n.BOARD_SIZE*n.BOARD_SIZE-o[this._difficulty],r=[];this.clearBoard(),this._solveGame(!0);for(var s,a=0;a<n.BOARD_SIZE;a++)for(s=0;s<n.BOARD_SIZE;s++)r.push([a,s]),this._predefined[a*n.BOARD_SIZE+s]=!0,this._solution[a][s]=this._board[a][s];for(;i>0&&r.length>0;)t=parseInt(Math.random()*r.length),e=r[t],this._board[e[0]][e[1]]=n.EMPTY_CELL,this._predefined[e[0]*n.BOARD_SIZE+e[1]]=!1,r.splice(t,1),i--;this._hasSolution=!0},o.prototype.getAllConflicts=function(){for(var t,e,o,i,r={},s=[],a=[],u=[],c=[],l=0;l<n.BOARD_SIZE;l++)for(var d=0;d<n.BOARD_SIZE;d++)if(!this.isPredefined(l,d)&&this._board[l][d]!==n.EMPTY_CELL){i=this.getConflictsFor(this._board[l][d],l,d),t=this.getBoxIndexFor(l,d),i.length>0&&(r[l+","+d]||(r[l+","+d]=!0,s.push([l,d])));for(var f=0;f<i.length;f++)e=i[f],o=this.getBoxIndexFor(e[0],e[1]),t!=o?(e[0]===l&&-1===a.indexOf(e[0])&&a.push(e[0]),e[1]==d&&-1===u.indexOf(e[1])&&u.push(e[1])):-1===c.indexOf(o)&&c.push(o),r[e[0]+","+e[1]]||(r[e[0]+","+e[1]]=!0,s.push(e))}return{cells:s,rows:a,columns:u,boxes:c}},o.prototype.getBoxIndexFor=function(t,e){return 3*parseInt(t/3)+parseInt(e/3)},o.prototype.isSolutionFor=function(t,e,o){return 0===this.getConflictsFor(t,e,o,!0).length},o.prototype.getConflictsFor=function(t,e,o,r){function s(t,e,o,i){o[t+","+e]||(o[t+","+e]=!0,i.push([t,e]))}t=parseInt(t),e=parseInt(e),o=parseInt(o),i(t>=1&&9>=t,"Guess should be in range [1-9]"),i(e>=0&&e<=n.BOARD_SIZE,"Invalid row "+e),i(o>=0&&o<=n.BOARD_SIZE,"Invalid column "+o),r=r===!0;var a,u,c=3*parseInt(e/3),l=3*parseInt(o/3),d={},f=[],h=this._board[e][o];this._board[e][o]=n.EMPTY_CELL;for(var _=0;_<n.BOARD_SIZE&&(r&&f.length<1||!r);_++)this._board[_][o]===t&&s(_,o,d,f),this._board[e][_]===t&&s(e,_,d,f),a=c+parseInt(_/3),u=l+_%3,this._board[a][u]===t&&s(a,u,d,f);return this._board[e][o]=h,f},o.prototype.setBoard=function(t){i("string"==typeof t,"The board should be a string");var e,o,r,s,a=0,u=48,c=120;this.clearBoard();for(var l=0;l<t.length;l++)if(e=t.charCodeAt(l),o=e-u,e===c)a++;else if(o>=1&&9>=o){if(r=parseInt(a/n.BOARD_SIZE),s=a%n.BOARD_SIZE,!this.isSolutionFor(o,r,s))return this.clearBoard(),!1;this._board[r][s]=o,this._predefined[a]=!0,a++}return!0},o.prototype.isPredefined=function(t,e){return this._predefined[t*n.BOARD_SIZE+e]===!0},o.prototype.solve=function(){if(this._hasSolution){for(var t=0;t<n.BOARD_SIZE;t++)for(var e=0;e<n.BOARD_SIZE;e++)this.isPredefined(t,e)||(this._board[t][e]=this._solution[t][e]);return!0}return this._solveGame(!1)},o.prototype._solveGame=function(t){function e(t,i){var r,s,a;if(t>=n.BOARD_SIZE)return!0;if(i+1<n.BOARD_SIZE?(s=t,a=i+1):(s=t+1,a=0),this.isPredefined(t,i))return e.call(this,s,a);for(r=0;9>r;r++)if(this.isSolutionFor(o[r],t,i)){if(this._board[t][i]=o[r],e.call(this,s,a))return!0;this._board[t][i]=n.EMPTY_CELL}return!1}for(var o=[],i=1;9>=i;i++)o.push(i);return t&&o.sort(function(){return parseInt(3*Math.random())-1}),this.clearBoard(!0),e.call(this,0,0)},o.prototype.isSolved=function(){for(var t=0;t<n.BOARD_SIZE;t++)for(var e=0;e<n.BOARD_SIZE;e++)if(!this.isPredefined(t,e)){if(this._board[t][e]===n.EMPTY_CELL)return!1;if(!this.isSolutionFor(this._board[t][e],t,e))return!1}return!0},o.prototype.toString=function(){for(var t="",e=0;e<n.BOARD_SIZE;e++){for(var o=0;o<n.BOARD_SIZE;o++)t+=this._board[e][o]===n.EMPTY_CELL?"x":this._board[e][o],o>0&&(o+1)%3===0&&o+1<n.BOARD_SIZE&&(t+="|");t+="\n",e>0&&(e+1)%3===0&&e+1<n.BOARD_SIZE&&(t+="―――――――――――",t+="\n")}return t},o.prototype.clone=function(){for(var t=o.empty(),e=0;e<n.BOARD_SIZE;e++)for(var i=0;i<n.BOARD_SIZE;i++)t._board[e][i]=this._board[e][i];return t},o.prototype.forEachCell=function(t,e){e=e||this;for(var i=o.empty(),r=0;r<n.BOARD_SIZE;r++)for(var s=0;s<n.BOARD_SIZE;s++)t.call(e,this._board[r][s],r,s);return i},o.prototype.getCellAt=function(t,e){return this._board[t][e]},o.prototype.setCellAt=function(t,e,o){t=parseInt(t),e=parseInt(e),o=parseInt(o),this.isPredefined(e,o)||(this._board[e][o]=t)},o.prototype.getNextAnswer=function(){for(var t=0;t<n.BOARD_SIZE;t++)for(var e=0;e<n.BOARD_SIZE;e++)if(!this.isPredefined(t,e)&&this._board[t][e]!==this._solution[t][e])return{row:t,column:e,answer:this._solution[t][e]};return null},o.beginner=function(){return new o(n.DIFFICULTY_BEGINNER)},o.easy=function(){return new o(n.DIFFICULTY_EASY)},o.medium=function(){return new o(n.DIFFICULTY_MEDIUM)},o.hard=function(){return new o(n.DIFFICULTY_HARD)},o.expert=function(){return new o(n.DIFFICULTY_EXPERT)},o.empty=function(){return new o(n.DIFFICULTY_EMPTY)},e.exports=o},{"./assert":4,"./constants":5}],3:[function(t,e){"use strict";function o(t){this._container=document.querySelector(t),this._timer=0,this._time=0,this.start()}o.prototype.start=function(){this._timer||(this._step(),this._timer=setInterval(this._step.bind(this),1e3))},o.prototype.stop=function(){this._timer&&(clearInterval(this._timer),this._timer=0)},o.prototype.reset=function(){this._time=0,this.stop(),this._step(),this._time=0},o.prototype._step=function(){var t=parseInt(this._time/3600),e=parseInt(this._time/60)%60,o=this._time%60,i=0!==t?t+":":"";i+=10>e?"0"+e+":":e+":",i+=10>o?"0"+o:o,this._container.innerHTML=i,this._time++},e.exports=o},{}],4:[function(t,e){"use strict";e.exports=function(t,e){if(!t)throw new Error(e)}},{}],5:[function(t,e){"use strict";e.exports={DIFFICULTY_BEGINNER:0,DIFFICULTY_EASY:1,DIFFICULTY_MEDIUM:2,DIFFICULTY_HARD:3,DIFFICULTY_EXPERT:4,DIFFICULTY_EMPTY:5,BOARD_SIZE:9,EMPTY_CELL:0}},{}],6:[function(t,e){"use strict";function o(t){p=new d(t),_=new f(".sudoku-container",p),I?(I.reset(),I.start()):I=new h(".sudoku-timer"),document.body.classList.add("box-effect-game-on")}function i(){if(_){if(!p.isSolved()&&!confirm("Do you really need to give up? come on"))return;p.solve(),_.update(),I.stop()}}function n(){_&&(I.start(),p.clearBoard(!0),_.update())}function r(){_&&_.nextHint()}function s(){document.body.classList.remove("box-effect-game-on"),document.activeElement&&document.activeElement.blur()}function a(t){var e=t.target;if(e&&e.hasAttribute("difficulty"))switch(e.getAttribute("difficulty")){case"beginner":o(l.DIFFICULTY_BEGINNER);break;case"easy":o(l.DIFFICULTY_EASY);break;case"medium":o(l.DIFFICULTY_MEDIUM);break;case"hard":o(l.DIFFICULTY_HARD);break;case"expert":o(l.DIFFICULTY_EXPERT)}}function u(t){var e=t.target;e.classList.contains("btn-solve")?i():e.classList.contains("btn-hint")?r():e.classList.contains("btn-clear")?n():e.classList.contains("btn-back")&&s()}var c=t("domready"),l=t("./constants"),d=t("./Sudoku"),f=t("./Board"),h=t("./Timer"),_=null,p=null,I=null,E=!!("ontouchstart"in window),v=E?"touchend":"click";c(function(){var t=document.querySelector(".dropdown-difficulty .dropdown-menu"),e=document.querySelector(".sudoku-controls");t.addEventListener(v,a,!1),e.addEventListener(v,u,!1)}),e.exports={Sudoku:d},window.game=e.exports},{"./Board":1,"./Sudoku":2,"./Timer":3,"./constants":5,domready:7}],7:[function(t,e){!function(t,o){"undefined"!=typeof e?e.exports=o():"function"==typeof define&&"object"==typeof define.amd?define(o):this[t]=o()}("domready",function(){var t,e=[],o=document,i=o.documentElement.doScroll,n="DOMContentLoaded",r=(i?/^loaded|^c/:/^loaded|^i|^c/).test(o.readyState);return r||o.addEventListener(n,t=function(){for(o.removeEventListener(n,t),r=1;t=e.shift();)t()}),function(t){r?t():e.push(t)}})},{}]},{},[6]);
